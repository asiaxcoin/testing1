<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1,viewport-fit=cover" />
  <title>ASIAXworld — asiax for everone</title>
  <!-- Bootstrap 5 (mobile-first) -->  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome for icons -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <!-- Ethers.js v5 UMD (Polygon compatible) -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script> 
  <style>
    :root{
      --bg:#071017;
      --card:#0d1b23;
      --muted:#9fb3bf;
      --accent:#00d1b2;
      --glass: rgba(255,255,255,0.04);
    }
    html,body{height:100%;}
    body{
      background: radial-gradient(1200px 500px at 10% 10%, rgba(0,209,178,0.06), transparent),
                  linear-gradient(180deg,#071017 0%, #06111a 100%);
      color: #e6f7f4;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      -webkit-font-smoothing:antialiased;
      padding:12px;
    }

    /* App shell */
    .app { max-width:420px; margin:0 auto; }

    .topbar{ display:flex;align-items:center;gap:12px;justify-content:space-between; padding:10px 6px; }
    .brand{ display:flex;align-items:center;gap:10px; }
    .logo { width:44px;height:44px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#3ad7ff);
            display:grid;place-items:center;font-weight:700;color:#022;box-shadow:0 6px 18px rgba(0,0,0,0.6); }
    h1.app-title{font-size:1rem;margin:0}
    p.app-sub{margin:0;font-size:0.78rem;color:var(--muted)}

    /* Animated cards */
    .card-app{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border: 1px solid rgba(255,255,255,0.04);
      border-radius:18px;padding:14px;margin-bottom:12px;backdrop-filter: blur(6px);
      box-shadow: 0 10px 30px rgba(2,8,12,0.6);
      transform-origin:center;animation:float 6s ease-in-out infinite;
    }
    @keyframes float{0%{transform:translateY(0px)}50%{transform:translateY(-6px)}100%{transform:translateY(0px)}}

    .stats-row{display:flex;gap:10px}
    .stat{ flex:1;padding:12px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
           display:flex;flex-direction:column;align-items:flex-start;gap:6px;min-width:0; }
    .stat .value{font-weight:700;font-size:1.05rem}
    .stat small{color:var(--muted)}

    /* Actions */
    .btn-lg-rounded{border-radius:12px;padding:10px 14px;font-weight:600}

    /* Form inputs */
    .form-control{
      background:transparent;border:1px solid rgba(255,255,255,0.06);border-radius:10px;color:inherit;
      height:44px;padding:10px;
    }

    /* Floating bottom nav */
    .bottom-nav{
      position:fixed;left:50%;transform:translateX(-50%);bottom:14px;width:calc(100% - 28px);max-width:420px;
      display:flex;gap:8px;justify-content:space-between;z-index:40;
    }
    .nav-btn{flex:1;padding:10px;border-radius:12px;background:linear-gradient(90deg, rgba(255,255,255,0.02), transparent);
             border:1px solid rgba(255,255,255,0.03);display:flex;align-items:center;justify-content:center;gap:8px}

    @media(min-width:560px){body{padding:20px}}

    .pulse{animation:pulse 2s infinite}
    @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(0,209,178,0.25)}70%{box-shadow:0 0 0 14px rgba(0,209,178,0)}100%{box-shadow:0 0 0 0 rgba(0,209,178,0)}}

    .small-muted{font-size:0.78rem;color:var(--muted)}
  </style>
</head>
<body>
  <div class="app">
    <div class="topbar">
      <div class="brand">
        <div class="logo"><i class="fa-solid fa-water" style="color:#022"></i></div><div>
          <h1 class="app-title">ASIAX WORLD</h1>
          <p class="app-sub">asiax for everone</p>
        </div>
      </div>
      <div>
        <button id="connectBtn" class="btn btn-sm btn-outline-light pulse">
          <i class="fa-solid fa-wallet"></i>&nbsp;<span id="connectLabel">Connect</span>
        </button>
      </div>
    </div>

    <!-- DASHBOARD CARD -->
    <div class="card-app">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <div>
          <div class="small-muted">Hello,</div>
          <div style="font-weight:700;font-size:1.05rem" id="userAddress">Not connected</div>
        </div>
        <div style="text-align:right">
          <div class="small-muted">Total Users</div>
          <div id="totalUsers" style="font-weight:700">0</div>
        </div>
      </div>

      <div class="stats-row mt-3">
        <div class="stat">
          <div class="small-muted">Total Investment</div>
          <div class="value"><i class="fa-solid fa-coins"></i>&nbsp;<span id="totalInvestment">0</span></div>
        </div>
        <div class="stat">
          <div class="small-muted">Wallet Balance</div>
          <div class="value"><i class="fa-solid fa-wallet"></i>&nbsp;<span id="walletBalance">0</span></div>
        </div>
      </div>

      <div class="stats-row mt-2">
        <div class="stat">
          <div class="small-muted">Pending ROI</div>
          <div class="value"><i class="fa-solid fa-chart-line"></i>&nbsp;<span id="pendingROI">0</span></div>
        </div>
        <div class="stat">
          <div class="small-muted">Total Withdrawn</div>
          <div class="value"><i class="fa-solid fa-hand-holding-dollar"></i>&nbsp;<span id="totalWithdrawn">0</span></div>
        </div>
      </div>
    </div>

    <!-- INVEST CARD -->
    <div class="card-app">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <div class="small-muted">Invest</div>
          <div style="font-weight:700">Join & Add Funds</div>
        </div>
        <div style="font-size:1.2rem;color:var(--accent)"><i class="fa-solid fa-hand-holding-dollar"></i></div>
      </div>

      <div class="mt-3">
        <input id="referrer" class="form-control" placeholder="Referrer address (optional)" />
        <div class="input-group mt-2">
          <input id="amount" type="number" class="form-control" placeholder="Amount (USDT)" />
          <button id="maxBtn" class="btn btn-outline-light" style="border-radius:8px">Max</button>
        </div>
        <div class="d-grid mt-3">
          <button id="investBtn" class="btn btn-lg btn-success btn-lg-rounded"><i class="fa-solid fa-paper-plane"></i> Invest</button>
        </div>
      </div>
    </div>

    <!-- ACTIONS CARD -->
    <div class="card-app">
      <div class="d-flex gap-2">
        <button id="withdrawBtn" class="btn btn-outline-light flex-fill"><i class="fa-solid fa-arrow-up-right-from-square"></i><br><small class="small-muted">Withdraw</small></button>
        <button id="claimBtn" class="btn btn-outline-light flex-fill"><i class="fa-solid fa-gift"></i><br><small class="small-muted">Claim Pools</small></button>
        <button id="refreshBtn" class="btn btn-outline-light flex-fill"><i class="fa-solid fa-rotate"></i><br><small class="small-muted">Refresh</small></button>
      </div>
    </div>

    <!-- WALLET WITHDRAW CARD -->
    <div class="card-app">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <div class="small-muted">Wallet Withdraw</div>
          <div style="font-weight:700">Fast Withdraw</div>
        </div>
        <div style="font-size:1.2rem;color:#ffb86b"><i class="fa-solid fa-hand-holding-dollar"></i></div>
      </div>
      <div class="mt-3 d-flex gap-2">
        <input id="withdrawAmount" class="form-control" placeholder="Amount (USDT)" />
        <button id="walletWithdrawBtn" class="btn btn-warning">Go</button>
      </div>
    </div><div class="card-app small-muted" style="font-size:0.9rem">
      <div><strong>Note:</strong> Contract not verified — add contract & token addresses in the script below. Use Polygon Mainnet for live testing.</div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
      <div class="nav-btn" id="navHome"><i class="fa-solid fa-house"></i></div>
      <div class="nav-btn" id="navInvest"><i class="fa-solid fa-coins"></i></div>
      <div class="nav-btn" id="navStats"><i class="fa-solid fa-chart-simple"></i></div>
      <div class="nav-btn" id="navMore"><i class="fa-solid fa-ellipsis"></i></div>
    </div>
  </div>

<script>
  // ---------- CONFIG: Replace with your contract/token addresses ----------
  const CONTRACT_ADDRESS = "0x76899eB10E3F04d896144D85B4433ac0c1c68189";
  const TOKEN_ADDRESS = "0xFEF338fB8B658FF1C564407322b2237D0FbDf260";

  const ABI = [
    "function invest(address _referrer, uint256 _amount) external",
    "function withdraw() external",
    "function claimPoolRewards() external",
    "function WalletWithdraw(uint256 _amount) external",
    "function userBasic(address) view returns (address,uint256,uint256,uint256,uint256,uint256,uint256,uint256,uint256,uint256,uint256)",
    "function userWallet(address) view returns (uint256,uint256,uint256)",
    "function totalUsers() view returns (uint256)"
  ];
    const TOKEN_ABI = [
  "function balanceOf(address) view returns (uint256)"
];

  let provider, signer, contract;

  function short(addr){ if(!addr) return '—'; return addr.slice(0,6)+"..."+addr.slice(-4);}

  async function connectWallet(){
    try{
      if(!window.ethereum){ alert("Install MetaMask or compatible wallet"); return; }
      await window.ethereum.request({ method:"eth_requestAccounts" });
      provider = new ethers.providers.Web3Provider(window.ethereum);
      signer = provider.getSigner();
      const address = await signer.getAddress();
      document.getElementById('userAddress').innerText = short(address);
      document.getElementById('connectLabel').innerText = 'Connected';
      document.getElementById('connectBtn').classList.remove('pulse');
      contract = new ethers.Contract(CONTRACT_ADDRESS, ABI, signer);
      loadUserData();
    }catch(err){ console.error(err); alert("Connection failed: "+(err.message||err)); }
  }

  async function loadUserData(){
    try{
      const address = await signer.getAddress();
      const basic = await contract.userBasic(address);
      const wallet = await contract.userWallet(address);
      const usersCount = await contract.totalUsers();

      document.getElementById('totalInvestment').innerText = ethers.utils.formatUnits(basic[1],18);
      document.getElementById('walletBalance').innerText = ethers.utils.formatUnits(wallet[0],18);
      document.getElementById('totalWithdrawn').innerText = ethers.utils.formatUnits(basic[4],18);
      document.getElementById('pendingROI').innerText = '0';
      document.getElementById('totalUsers').innerText = usersCount.toString();
    }catch(err){ console.error(err); }
  }

  async function approveToken(spender, amount){
    const tokenAbi = ["function approve(address,uint256) public returns (bool)"];
    const token = new ethers.Contract(TOKEN_ADDRESS, tokenAbi, signer);
    const tx = await token.approve(spender, amount);
    await tx.wait();
    return tx;
  }

  async function invest(){
    if(!contract){ alert('Connect wallet first'); return; }
    const rawAmount = document.getElementById('amount').value;
    if(!rawAmount || Number(rawAmount)<=0){ alert('Enter valid amount'); return; }
    const ref = document.getElementById('referrer').value || ethers.constants.AddressZero;
    const amount = ethers.utils.parseUnits(rawAmount,18);
    try{
      await approveToken(CONTRACT_ADDRESS, amount);
      const tx = await contract.invest(ref,amount);
      alert('Invest tx sent: '+tx.hash);
      await tx.wait();
      alert('Invest successful');
      loadUserData();
    }catch(err){ console.error(err); alert('Invest failed: '+(err.message||err)); }
  }async function withdraw(){
    if(!contract){ alert('Connect wallet first'); return; }
    try{
      const tx = await contract.withdraw();
      alert('Withdraw tx sent: '+tx.hash);
      await tx.wait();
      alert('Withdraw successful');
      loadUserData();
    }catch(err){ console.error(err); alert('Withdraw failed: '+(err.message||err)); }
  }

  async function claimPools(){
    if(!contract){ alert('Connect wallet first'); return; }
    try{
      const tx = await contract.claimPoolRewards();
      alert('Claim tx sent: '+tx.hash);
      await tx.wait();
      alert('Claim successful');
      loadUserData();
    }catch(err){ console.error(err); alert('Claim failed: '+(err.message||err)); }
  }

  async function walletWithdraw(){
    if(!contract){ alert('Connect wallet first'); return; }
    const raw = document.getElementById('withdrawAmount').value;
    if(!raw || Number(raw)<=0){ alert('Enter amount'); return; }
    const amount = ethers.utils.parseUnits(raw,18);
    try{
      const tx = await contract.WalletWithdraw(amount);
      alert('Wallet Withdraw tx sent: '+tx.hash);
      await tx.wait();
      alert('Wallet Withdraw successful');
      loadUserData();
    }catch(err){ console.error(err); alert('Wallet withdraw failed: '+(err.message||err)); }
  }

  document.getElementById('connectBtn').addEventListener('click',connectWallet);
  document.getElementById('investBtn').addEventListener('click',invest);
  document.getElementById('withdrawBtn').addEventListener('click',withdraw);
  document.getElementById('claimBtn').addEventListener('click',claimPools);
  document.getElementById('walletWithdrawBtn').addEventListener('click',walletWithdraw);
  document.getElementById('refreshBtn').addEventListener('click', ()=>{ if(signer) loadUserData(); else alert('Connect wallet first') });
  document.getElementById('maxBtn').addEventListener('click', ()=>{ document.getElementById('amount').value='1000'; });
  document.getElementById('navHome').addEventListener('click',()=>{window.scrollTo({top:0,behavior:'smooth'});});
  document.getElementById('navInvest').addEventListener('click',()=>{document.getElementById('amount').focus();});

  if(window.ethereum){
    window.ethereum.on('accountsChanged',(accounts)=>{ if(accounts.length==0){ location.reload(); } else { connectWallet(); } });
    window.ethereum.on('chainChanged',(chainId)=>{ console.log('chain changed',chainId); connectWallet(); });
  }
</script>
</body>
</html>